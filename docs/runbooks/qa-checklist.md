# QA Checklist\n\n## ON/OFF Matrix: Feature Flags\n\nTest each feature flag in both ON and OFF states. Record results.\n\n### Setup\n- Storefront: http://localhost:3000 (or deployed URL)\n- Admin: http://localhost:3000/admin (Vendure)\n- CMS: http://localhost:1337 (Strapi)\n- Test user: test@example.com / password (or guest checkout)\n- Test product: \"Demo Protein Shake\" (SKU: PROTEIN-001)\n\n---\n\n## M9: Storefront Shells & PWA Baseline\n\n### Core Flow: Browse → Cart → Checkout\n\n**All flags OFF (except default truthy values)**\n\n- [ ] Home page loads without errors (no 5xx)\n- [ ] Collections list shown (e.g., \"Proteins\", \"Bars\")\n- [ ] Collection page (PLP) loads; shows 5+ products\n- [ ] Product page (PDP) loads; shows variants, images, price\n- [ ] Add to cart works; cart count updates\n- [ ] Cart drawer/page shows correct items + total\n- [ ] Checkout page loads (multi-step)\n  - [ ] Address form: can enter & validate\n  - [ ] Shipping method: shows at least 1 option\n  - [ ] Payment method: shows at least 1 option (fallback)\n  - [ ] Submit: order created; no errors\n- [ ] Confirmation page shows order #, total, items\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### PWA Manifest & Service Worker\n\n- [ ] Manifest file exists: `/manifest.json`\n- [ ] Manifest valid JSON; has `name`, `short_name`, `icons`, `start_url`\n- [ ] Service worker registered (DevTools → Application → Service Workers)\n- [ ] Offline fallback: disable network → reload PDP → should show cached content + offline indicator\n- [ ] Install prompt (if pwa.enabled=true):\n  - [ ] Prompt appears after 10s on home page\n  - [ ] \"Add to home screen\" button clickable\n  - [ ] Dismiss: remember for 30 days\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### SEO & Structured Data\n\n- [ ] Home page: `<title>`, `<meta name=\"description\">`\n- [ ] PLP page: title includes collection name (e.g., \"Proteins – Impact Nutrition\")\n- [ ] PDP page: title includes product name; `<meta property=\"og:image\">` set\n- [ ] Structured data (DevTools → Inspect → Source): valid JSON-LD for Product, Collection\n- [ ] Images: all have `alt` text\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Responsive Design\n\n- [ ] Mobile (320px): no horizontal scroll, readable text\n- [ ] Tablet (768px): layout adapts; images scale\n- [ ] Desktop (1024px+): full layout, sidebar menus\n- [ ] Touch targets: buttons ≥44px on mobile\n\n**Result**: ✓ PASS / ❌ FAIL\n\n---\n\n## M9: Payments (GPG Checkout) END-to-END\n\n### GPG Enabled (payments.gpgEnabled = true)\n\n1. **Toggle in Strapi**: StoreConfig → Features → `payments.gpgEnabled = true` → Publish\n2. **Reload storefront**: clear cache (Ctrl+Shift+R)\n3. **Proceed through checkout**:\n   - [ ] Payment step shows \"GPG Checkout\" as option\n   - [ ] Select GPG Checkout\n   - [ ] Click \"Pay Now\"\n   - [ ] Redirected to GPG hosted page (iframe or new tab)\n   - [ ] GPG page shows order amount, merchant name\n4. **Complete test payment**:\n   - [ ] Enter test card (from GPG sandbox docs)\n   - [ ] Submit\n   - [ ] Redirected back to `/checkout/confirmation?orderId=...`\n5. **Verify order state**:\n   - [ ] Order marked \"Paid\" (Vendure admin)\n   - [ ] Confirmation email sent\n   - [ ] Loyalty points earned (if loyalty flag ON)\n6. **Check logs**:\n   - [ ] Webhook received (search logs for GPG event)\n   - [ ] Signature validation passed\n   - [ ] No errors\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### GPG Disabled (payments.gpgEnabled = false)\n\n1. **Toggle in Strapi**: `payments.gpgEnabled = false` → Publish\n2. **Reload storefront**: clear cache\n3. **Proceed to checkout**:\n   - [ ] Payment step: GPG Checkout NOT shown\n   - [ ] Only fallback payment method visible\n   - [ ] Can complete checkout with fallback\n4. **Verify**:\n   - [ ] Order created successfully\n   - [ ] No errors\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### GPG Error Scenarios\n\n- [ ] **Card declined**: test card from GPG docs → error message shown (\"Your card was declined\")\n- [ ] **Timeout**: stop API → attempt payment → error message (\"Unable to process payment\")\n- [ ] **Invalid address**: checkout with missing zip → validation error before GPG redirect\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Payment State Transitions\n\n- [ ] Webhook: authorized → captured → order marked \"Paid\"\n- [ ] Refund webhook: order marked \"Refunded\"; ledger entry created (loyalty reversed)\n- [ ] Duplicate webhook (same transactionId): idempotent; no double-charge\n- [ ] Signature validation fails: webhook rejected; alert logged\n\n**Result**: ✓ PASS / ❌ FAIL\n\n---\n\n## M10: Shipping File Bridge\n\n### Scheduled Export (shipping.fileBridgeEnabled = true)\n\n1. **Create order**:\n   - [ ] Order created and marked \"Paid\"\n   - [ ] Manual transition to \"Ready to Ship\" (or automatic)\n2. **Trigger scheduled export**:\n   - [ ] Cron job runs (from SHIP_EXPORT_SCHEDULE)\n   - [ ] Export batch created\n3. **Verify file**:\n   - [ ] File uploaded to SFTP/HTTPS destination\n   - [ ] File contains correct order data (order_id, customer_name, items_skus, etc.)\n   - [ ] CSV columns match spec\n4. **Check order metadata**:\n   - [ ] Order marked with `exported_at`, `batch_id`\n   - [ ] Order status (optional): \"In Transit\" or \"Ready to Ship\"\n5. **Check logs**:\n   - [ ] Batch creation logged\n   - [ ] Upload logged (file size, latency)\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Manual Export\n\n1. **API call**: `POST /admin/orders/export-shipping?dateRange=last24h`\n2. [ ] Batch ID returned\n3. [ ] File generated + uploaded\n4. [ ] Response: status \"success\"\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Export Failure & Retry\n\n1. **Simulate upload failure** (disable SFTP credentials)\n2. [ ] Export attempt fails; batch marked \"Failed\"\n3. [ ] Automatic retry: batch retried after 30s (3 attempts max)\n4. [ ] After 3 failures: batch marked \"Failed\"; alert logged\n5. **Restore credentials**\n6. [ ] Manual re-export: `POST /admin/orders/export-shipping?batchId=...`\n7. [ ] New batch ID created; file uploaded successfully\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Shipping Disabled (shipping.fileBridgeEnabled = false)\n\n1. **Toggle flag**: `shipping.fileBridgeEnabled = false`\n2. **Create \"Ready to Ship\" order**:\n   - [ ] No auto-export triggered\n   - [ ] No batch created\n3. [ ] Manual export API disabled / returns error\n\n**Result**: ✓ PASS / ❌ FAIL\n\n---\n\n## M9: Loyalty (Earn/Burn)\n\n### Loyalty Enabled (loyalty = true)\n\n**Earn**:\n1. **Create order**: $100 subtotal → $108 with tax\n2. **Mark \"Paid\"**\n3. [ ] Ledger entry created: `awarded`, points = 108 (1% rate)\n4. **Account page** (`/account/loyalty`):\n   - [ ] Balance shows 108 points (= $1.08 credit)\n   - [ ] Ledger shows transaction\n\n**Burn**:\n1. **Create new order**: $100 subtotal\n2. **Checkout**:\n   - [ ] Loyalty section shown: \"You have 108 points\"\n   - [ ] Redeem form: input field for points\n   - [ ] Select 10,000 points (if available; else enter max allowed)\n   - [ ] Preview: \"-$X.XX discount\"\n3. **Submit**:\n   - [ ] Discount applied to order total\n   - [ ] Balance updated: 108 - 10,000 = (if insufficient, error)\n4. **Email**: loyalty message shown (\"You earned X points on this order\")\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Loyalty Refund\n\n1. **Refund order** (that had earned points)\n2. [ ] Ledger entry created: `adjusted`, reversed points\n3. [ ] Customer balance restored\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Loyalty Disabled (loyalty = false)\n\n1. **Toggle flag**: `loyalty = false`\n2. [ ] Account page: no Loyalty section\n3. [ ] Checkout: no loyalty redeem form\n4. [ ] Email: no \"points earned\" message\n\n**Result**: ✓ PASS / ❌ FAIL\n\n---\n\n## M10: Search & Performance\n\n### Meilisearch Enabled (search.meiliEnabled = true)\n\n1. **Navigate to** `/search`\n2. **Enter query**: \"protein\"\n   - [ ] Results returned in <100ms\n   - [ ] Results include products matching title\n3. **Typo tolerance**: \"protien\" (misspelled)\n   - [ ] Results still show \"protein\" products (typo corrected)\n4. **Filters**: price range 10–50\n   - [ ] Results filtered correctly\n5. **Sort**: by price ascending\n   - [ ] Results sorted\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Meilisearch Disabled (search.meiliEnabled = false)\n\n1. **Toggle**: `search.meiliEnabled = false`\n2. **Navigate to** `/search`\n3. **Enter query**: \"protein\"\n   - [ ] Results returned (fallback to API filter)\n   - [ ] Latency acceptable (may be slower, ~500ms–2s)\n4. **Typo tolerance**: \"protien\"\n   - [ ] No results (fallback doesn't support typo tolerance)\n   - [ ] Suggestion: \"Did you mean 'protein'?\" (future)\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Performance: Core Web Vitals\n\n**Measurement**:\n- Use DevTools → Lighthouse (mobile)\n- Or: https://web.dev/measure\n\n**Targets**:\n- [ ] LCP <2.5s (Largest Contentful Paint)\n- [ ] FID <100ms (First Input Delay)\n- [ ] CLS <0.1 (Cumulative Layout Shift)\n\n**Notes**: May not reach targets in development; focus on relative improvement.\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Caching: Redis\n\n**Test**: Request same product page twice\n- [ ] First request: hits API (cache miss)\n- [ ] Second request: served from Redis (cache hit)\n- **Verify**: logs show hit (check `/api/logs/cache`)\n\n**Result**: ✓ PASS / ❌ FAIL\n\n---\n\n## M9: Content & SEO\n\n### Content Pages\n\n1. **Navigate to** `/content/about`\n   - [ ] Page loads (fetches from Strapi)\n   - [ ] Content displays correctly\n2. **Edit in Strapi**:\n   - [ ] Change content → Publish\n   - [ ] Reload web page → changes visible (ISR)\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### SEO: Sitemap\n\n1. **Navigate to** `/sitemap.xml`\n   - [ ] Valid XML\n   - [ ] Includes: home, all collections, all products (or subset), content pages\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### SEO: Structured Data\n\n1. **PDP**: inspect page source\n   - [ ] JSON-LD `Product` schema present\n   - [ ] Fields: name, image, price, description\n2. **Home**: inspect source\n   - [ ] JSON-LD `Organization` schema present\n   - [ ] Fields: name, logo, sameAs (social links)\n\n**Result**: ✓ PASS / ❌ FAIL\n\n---\n\n## M10: Admin UI Elevation\n\n### Dashboard\n\n1. **Navigate to** Admin dashboard\n   - [ ] Revenue card: today's sales, AOV\n   - [ ] Top products: list of 5\n   - [ ] Top customers: list of 10\n   - [ ] Low stock alerts: any products <threshold?\n   - [ ] Fulfillment backlog: count of orders in \"Paid\"\n2. **Data accuracy**: check a card value against actual data\n   - [ ] Value correct?\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Orders Board (Kanban)\n\n1. **Navigate to** Orders Board\n   - [ ] Columns shown: Paid, Picking, Picked, Shipped, Delivered\n   - [ ] Orders populated in correct column\n2. **Drag-to-transition**:\n   - [ ] Drag order from Paid → Picking\n   - [ ] Order state updated\n   - [ ] Reflect in order detail page\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Payment Timeline\n\n1. **Order detail page** (M3 payment order)\n   - [ ] Payment tab shown\n   - [ ] Timeline: Authorized → Captured\n   - [ ] Each state: timestamp, transaction ID\n   - [ ] Manual capture button (if applicable)\n\n**Result**: ✓ PASS / ❌ FAIL\n\n---\n\n## Mobile & Accessibility\n\n### Mobile (Portrait, 320px)\n\n- [ ] All pages responsive (no horizontal scroll)\n- [ ] Touch targets ≥44px\n- [ ] Images scale appropriately\n- [ ] Text readable (no zoom required for ≥16px)\n\n**Result**: ✓ PASS / ❌ FAIL\n\n### Accessibility (WCAG 2.1 AA)\n\n- [ ] Headings: proper hierarchy (h1, h2, h3)\n- [ ] Images: all have alt text\n- [ ] Buttons: labeled or aria-label\n- [ ] Color contrast: ≥4.5:1 for text\n- [ ] Keyboard navigation: all interactive elements reachable via Tab\n\n**Result**: ✓ PASS / ❌ FAIL\n\n---\n\n## Sign-Off\n\n**QA Engineer**: _________________  **Date**: __________\n\n**Milestone Passed**: ✓ YES / ❌ NO\n\n**Notes**:\n\n...\n\n**Known Issues**:\n\n...\n\n**Recommendations**:\n\n...\n